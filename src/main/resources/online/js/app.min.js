(function(c,a,n){c.app=c.app||{};var f=c.app;f.debug=!1;f.registeredNamespaces=[];c.curry=function(a,b){b=b||c;return function(){a.apply(b,arguments)}};c.curryWithArguments=function(a,b){var g=[];b=b||c;for(var d=2,e=arguments.length;d<e;d++)g.push(arguments[d]);return function(){a.apply(b,g)}};c.currySelf=function(a,b){return function(){for(var g=arguments.length;0<g;g--)arguments[g]=arguments[g-1];arguments[0]=b;arguments.length++;a.apply(this,arguments)}};c.setNamespace=function(a){a=a.split(".");
var b=c,g,d,e;d=0;for(e=a.length;d<e;d++)g=a[d],b[g]=b[g]||{},b=b[g];return b};c.use=function(a){a=a.split(".");for(var b=c,g;g=a.shift();)b=b[g]||{};return b};c.loadNamespace=function(l){var b;b=l.split(".");var g="/js/__path__.min.js?2.1.9";f.debug&&(g="http://__hostname__/js/__path__.js");b=b.splice(1,b.length-1);g=g.replace(/__hostname__/g,c.location.hostname).replace(/__path__/g,b.join("/"));b=c.curryWithArguments(c.initializeNamespace,c,l);c.hasNamespace(l)?c.initializeNamespace(l):
a.getScript(g).done(b).fail(function(a,b,g){console.log(l);eval(a);c.initializeNamespace(l)})};c.hasNamespace=function(a){a=a.split(".");var b=!0,g=c,d,e,k;e=0;for(k=a.length;e<k;e++){d=a[e];if(g[d]===n){b=!1;break}g=g[d]}return b};c.initializeNamespace=function(a){try{c.setNamespace(a).initialize()}catch(b){console.log("Cannot initialize namespace "+a+b)}};c.releaseNamespace=function(a){try{c.setNamespace(a).release()}catch(b){console.log("Cannot release namespace "+a+b)}};c.isCrippleBrowser=function(){var a=
navigator.userAgent,b=["MSIE 6","MSIE 7","MSIE 8","MSIE 9"],g,d;g=0;for(d=b.length;g<d;g++)if(0<=a.indexOf(b[g]))return!0;return!1};c.app.log=function(a){c.app.debug&&console.log(a)}})(window,jQuery);
(function(c,a){c.setNamespace("app.config").routes=[{route:"/competitions/{slug}/games/{id}/dump",action:"Competition/dump",requirements:{id:"[\\w-]+",slug:"[\\w-]+"}},{route:"/competitions/{slug}/games/{id}",action:"Competition/game",requirements:{id:"[\\w-]+",slug:"[\\w-]+"}},{route:"/competitions/{slug}/game/challenge",action:"Competition/challenge",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/finals",action:"Competition/finals",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/semi-finals/show",
action:"Competition/semiFinals",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/semi-finals/round",action:"Competition/showFinalsMatch",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/prizes",action:"Competition/prizes",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/game-log",action:"Competition/gameLog",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/leaderboard",action:"Competition/leaderboard",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/getting-started",
action:"Competition/gettingStarted",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/rules",action:"Competition/rules",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}/edit",action:"Competition/edit",requirements:{slug:"[\\w-]+"}},{route:"/competitions/{slug}",action:"Competition/show",requirements:{slug:"[\\w-]+"}},{route:"competitions",action:"Competition/index"},{route:"discussions",action:"Discussion/forum"},{route:"^/$",action:"Home/index"},{route:"/profile/edit",action:"Home/editProfile"},
{route:"/profile",action:"Home/profile"},{route:"/languages/",action:"Home/languages"}]})(window);
(function(c,a){var n=c.setNamespace("app"),f=[];n.Router=function(a){if(!1===this instanceof n.Router)return new n.Router(arguments);f=a};n.Router.prototype.route=function(){var a=this.match(c.location.pathname.replace("app_dev.php/","")),b;n.log("action "+a);null!==a&&(b=this.getControllerName(a),a=this.getMethodName(a),n.log(b),b=new n.controller[b],n.log(a),b[a]())};n.Router.prototype.match=function(a){var b,g,d,e,c,h;b=0;for(d=f.length;b<d;b++){g=f[b];e=g.route;h=g.requirements;for(c in h)g=RegExp("{"+
c+"}"),e=e.replace(g,h[c]);if(null!==a.match(e))return f[b].action}return null};n.Router.prototype.getControllerName=function(a){return a.split("/")[0]+"Controller"};n.Router.prototype.getMethodName=function(a){return a.split("/")[1]+"Action"}})(window);
(function(c,a,n,f){c.setNamespace("app.snippet").drawRankingGraph=function(c,b){function g(a,b,h,d,e,c){var m=(h-a)/2,g=(e-h)/2;a=Math.atan((h-a)/Math.abs(d-b));e=Math.atan((e-h)/Math.abs(d-c));a=b<d?Math.PI-a:a;e=c<d?Math.PI-e:e;c=Math.PI/2-(a+e)%(2*Math.PI)/2;b=m*Math.sin(c+a);m*=Math.cos(c+a);a=g*Math.sin(c+e);g*=Math.cos(c+e);return{x1:h-b,y1:d+m,x2:h+a,y2:d+g}}if(!(0>=n(".competition_"+b+" #profile-rankingOverTime-data").length)){var d,e=[],k=[],h=[],p=[];c.find("#profile-rankingOverTime-data tfoot th").each(function(){e.push(new Date(parseInt(n(this).html())))});
c.find("#profile-rankingOverTime-data tbody td").each(function(){d=n(this).html().split(" ");2===d.length&&(k.push(parseInt(d[0])),h.push(d[1]),-1===p.indexOf(d[1])&&p.push(d[1]))});if(e.length!==k.length&&e.length!==h.length)console.log("data not correct");else{var f,m,q,s,x,u,A,t,z,C,D,B,L,M,I,v;B=e.length;var w=a("profile-rankingOverTime-graph-"+b,320,385),F=256/B,y=Number.MAX_VALUE,E=-1,G=!1,H=255,N=255/p.length;u=w.rect(24,15,278,355).toBack();var J={"font-size":"14px","font-family":"'Maven Pro', Helvetica, Arial, sans-serif"};
w.set();var K=w.set();f=null;D=w.path().attr({"stroke-width":4,"stroke-linejoin":"round"});D.node.setAttribute("class","profile-rankingOverTime-graph-line");u.attr({fill:"rgba(0, 0, 0, 0.05)",stroke:"none"});v=w.popup(0,0,"","right",8).hide();v[0].attr({fill:"#000",stroke:"#737373","stroke-width":2,"fill-opacity":0.7});v[1].attr(J).attr({fill:"white","font-size":"13px"});I=w.text(0,377,"").attr(J);for(m=0;m<B;m++)k[m]<y&&(y=k[m]),k[m]>E&&(E=k[m]);u=355/(E-y+2);for(m=0;m<B;m++)q=Math.round(32+F*(m+
0.5)),s=(k[m]-y+1)*u+15,f!==h[m]&&(H-=N),f=w.circle(q,s,4).attr({fill:"rgb("+H+","+H+","+H+")","stroke-width":0}),m||(x=["M",q,s,"C",q,s]),m&&m<B-1&&(t=(k[m-1]-y+1)*u+15,A=Math.round(32+F*(m-0.5)),C=(k[m+1]-y+1)*u+15,z=Math.round(32+F*(m+1.5)),A=g(A,t,q,s,z,C),x=x.concat([A.x1,A.y1,q,s,A.x2,A.y2])),K.push(w.rect(32+F*m,15,F,355).attr({stroke:"none",fill:"#fff",opacity:0})),L=K[K.length-1],function(b,h,d,e,c,m){L.hover(function(){var g,f;g="right";var k="Rank "+e+"\nRevision "+c,p=d.getDate()+"-"+
(d.getMonth()+1)+"-"+d.getFullYear();clearTimeout(M);320<b+v.getBBox().width&&(g="left");g=w.popup(0,0,k,g,8);f=a.animation({transform:["t",b,h]},200*G);v[0].attr({path:g[0].attrs.path});v[0].show().stop().animate(f);v[1].attr({x:g[1].transform()[1][1]});v[1].attr({text:k}).show().stop().animateWith(v[0],f,{transform:["t",b,h]},200*G);I.attr({text:p}).show().stop().animate({transform:["t",b,0]},200*G);g.remove();m.attr("r",7);G=!0},function(){m.attr("r",4);M=setTimeout(function(){v.hide();I.hide();
G=!1},1)})}(q,s,e[m],k[m],h[m],f),f=h[m];B=w.text(12,u+15,y).attr(J);w.text(12,(E-y+1)*u+15,E).attr(J);y===E&&B.hide();x=x.concat([q,s,q,s]);D.attr({path:x});v.toFront();I.toFront();K.toFront()}}}})(window,window.Raphael,window.jQuery);
(function(c,a,n){c.setNamespace("app.snippet").slideShow=function(){function f(a){c.clearInterval(slideShowInterval);"slide-show-button-left"===a.attr("id")?l(!1):"slide-show-button-right"===a.attr("id")&&l(!0);c.slideShowInterval=setInterval(function(){l(!0)},m)}function l(b){var c,m,l,t,z,C,D=h.children().eq(1).children().first();e!=n&&e!=b&&(r=b?r+2:r-2);e=b;a(document).off("click",".slide-show-button");b?(c="-200%",m="10%",l="40%",C="-15%",z="10%",t=h.children().eq(2).children().first(),r=(2*
p+r+1)%p):(c="0%",m="-10%",l="-40%",C="15%",z="-10%",t=h.children().eq(0).children().first(),r=(2*p+r-1)%p);h.animate({marginLeft:c},q,function(){d=k.eq(r).clone();a(d).css("width",g+"px");b?(h.children().eq(0).detach(),h.append(d)):(h.children().eq(2).detach(),h.prepend(d));h.css("marginLeft","-100%");a(document).one("click",".slide-show-button",function(){f(a(this))})});t.css("opacity",0);t.css("marginLeft",m);t.delay(q/1.65).animate({opacity:1,marginLeft:0},0.7*q);D.animate({opacity:0,marginLeft:l},
0.7*q);c=b?h.children().eq(2).children().eq(1):h.children().eq(0).children().eq(1);c.css("opacity",0);c.css("marginLeft",z);c.delay(q/1.8).animate({opacity:1,marginLeft:0},0.7*q);0<a("#banner-competition-index").length&&(z=D.children().eq(1),t=t.children().eq(1),t.css("opacity",0),t.css("marginLeft",m),t.delay(q/1.8).animate({opacity:1,marginLeft:0},0.7*q),z.animate({opacity:0,marginLeft:C},0.7*q))}var b,g,d,e,k=a(".banner-slide"),h=a("#banner-slide-show"),p=k.length,r=1,m=1E4,q=800;k.css("display",
"inline");a.each(a(".banner-image"),function(){a(this).css("background-image","url("+a(this).attr("data-url")+")")});a.each(a(".banner-foreground-image"),function(){""!==a(this).attr("data-url")&&a(this).css("background-image","url("+a(this).attr("data-url")+")")});if(1<p){for(b=0;b<p;b++)k.eq(b).detach();k.eq(p-1).clone().appendTo("#banner-slide-show");k.eq(0).clone().appendTo("#banner-slide-show");k.eq(1).clone().appendTo("#banner-slide-show");h.css("margin-left","-100%");c.slideShowInterval=setInterval(function(){l(!0)},
m);a(document).one("click",".slide-show-button",function(){f(a(this))})}}})(window,window.jQuery);(function(c,a,n){c.setNamespace("app.snippet").addBodyClass=function(f){f=c.location.href.split("/");var l=f.indexOf("competitions");a("body").removeAttr("class");-1!=l&&(f=f[l+1],a("body").addClass(f))}})(window,window.jQuery);
(function(c,a,n){c.setNamespace("app.snippet").addFileUpload=function(c){a(document).bind("drop dragover",function(a){a.preventDefault()});a(".upload-bot-form").each(function(){a(this).fileupload({dropZone:a(this),done:function(c,b){a("#upload-bot-text").html("Your bot has been uploaded.");a.pjax({url:"/profile",container:"#page"})},progress:function(a,b){},start:function(c,b){a("#upload-bot-text").html("Your bot is being uploaded")}})})}})(window,window.jQuery);
(function(c,a,n){c.setNamespace("app.snippet").addSyntaxHighlighting=function(c){a("code").each(function(){a(this).parent().is("pre")?a(this).parent().addClass("prettyprint"):a(this).addClass("prettyprint")});prettyPrint()}})(window,window.jQuery);
(function(c,a,n){var f=c.setNamespace("app.snippet");f.loadCompetition=function(l){c.loadNamespace(["app.competitions",f.getCompetitionName()].join("."));var b=document.getElementById("player");b&&(b.contentWindow.focus(),a(document).on("click","#page *",function(){b.contentWindow.focus()}))}})(window,window.jQuery);
(function(c,a,n){var f=c.setNamespace("app.snippet");f.unloadCompetition=function(){c.releaseNamespace(["app.competitions",f.getCompetitionName()].join("."));a(document).off("pjax:click",f.unloadCompetition)}})(window,window.jQuery);
(function(c,a,n){c.setNamespace("app.snippet").getCompetitionName=function(){var a,l=c.location.href.split("/");if(l[a+1]===n||"competitions"!=l[3])l=c.initialURL.split("/");a=l.indexOf("competitions");a=l[a+1];"warlight-ai-challenge"===a&&(a="conquest");return a}})(window,window.jQuery);
(function(c,a,n){var f=c.setNamespace("app.controller"),l=c.setNamespace("app.snippet");f.CompetitionController=function(){if(!1===this instanceof f.CompetitionController)return new f.CompetitionController(arguments)};f.CompetitionController.prototype.indexAction=function(){app.log("CompetitionController::indexAction");l.slideShow();a(document).on("click",".competition-link-external",function(){a(".competition-index-overlay").addClass("show");var b=a(this).attr("data-href");a("#competition-index-message-button-confirm").data("href",
b)});a(document).on("click",".competition-index-overlay, #competition-index-message-button-cancel",function(b){b.target==this&&a(".competition-index-overlay").removeClass("show")});a(document).on("click","#competition-index-message-button-confirm",function(b){b.target==this&&(c.open(a(this).data("href")),a(".competition-index-overlay").removeClass("show"))})};f.CompetitionController.prototype.showAction=function(){function b(b){a.ajax({url:"/competitions/"+g+"/prizes/"+b,context:this,beforeSend:function(){a("#page").addClass("wait");
a(".currency-button").addClass("wait")}}).done(function(b){a("#show-prizes").replaceWith(b);a("#prizes-table td").each(function(){-1!==a(this).html().indexOf("Finals winner")&&a(this).css("color","#919191")});a("#page").removeClass("wait");a(".currency-button").removeClass("wait")})}app.log("CompetitionController::showAction");var g=c.location.href.split("/")[4];l.addFileUpload();l.loadCompetition();this.setMenuButtonSelected("Home");b("eu");a(document).on("click",".button-currency",function(){var d;
-1===a(this).attr("class").indexOf("selected")&&(d=a(this).attr("data-currency"),b(d))});a(document).on("pjax:end",l.unloadCompetition)};f.CompetitionController.prototype.gameAction=function(){app.log("CompetitionController::gameAction");l.loadCompetition();a(document).on("pjax:end",l.unloadCompetition)};f.CompetitionController.prototype.challengeAction=function(){app.log("CompetitionController::challengeAction");var b,g,d=a("#challenge-game").attr("data-url");0>=d.length?(g=c.location.href.split("/"),
g[g.length-1]="refresh",b=g.join("/"),setTimeout(function(){g=c.location.href.split("/");"game"===g[5]&&"challenge"===g[6]&&a.pjax({url:b,container:"#page"})},2400)):a.pjax({url:d,container:"#page"})};f.CompetitionController.prototype.dumpAction=function(){app.log("CompetitionController::dumpAction");l.addSyntaxHighlighting()};f.CompetitionController.prototype.rulesAction=function(){app.log("CompetitionController::rulesAction");this.setMenuButtonSelected("Rules")};f.CompetitionController.prototype.gettingStartedAction=
function(){app.log("CompetitionController::gettingStartedAction");l.addSyntaxHighlighting();this.setMenuButtonSelected("Getting Started")};f.CompetitionController.prototype.leaderboardAction=function(){function b(){var b,d,c,e;a(".graph-bar").each(function(g){b=parseInt(a(this).attr("data-win"));d=parseInt(a(this).attr("data-tie"));c=parseInt(a(this).attr("data-loss"));e=b+d+c;0!=e?(a(this).children("#graph-loss").css("flex-basis",100*c/e+"%"),a(this).children("#graph-tie").css("flex-basis",100*d/
e+"%")):a(this).addClass("no-games");a(this).css("opacity",1)})}function g(){var b=a("#leaderboard-sider").height()+200;a("#leaderboard").height()<b&&a("#leaderboard").height(b)}function d(){var b=a("#leaderboard-table tbody").children(),d=a("#leaderboard-data td"),c=[];0<d.length&&(d.each(function(){var b=a(this).html().split(",");c[parseInt(b[1])-1]=b[0]}),b.each(function(d,e){userName=a.trim(a(this).find(".bot-name").text());for(rank=0;rank<c.length;rank++)if(c[rank]==userName){d>rank?b.eq(rank).children().first().addClass("rise"):
d<rank&&b.eq(rank).children().first().addClass("fall");break}}))}app.log("CompetitionController::leaderboardAction");this.setMenuButtonSelected("Leaderboard");var e=a("#leaderboard-sider").offset().top,k=c.location.href.split("/")[4];a(".country-flag").each(function(){a(this).css("background","url("+a(this).attr("data-flag")+") center center no-repeat")});a("#leaderboard-sider").hasClass("show")&&b();-1!==c.location.pathname.indexOf("global")&&d();a(document).on("click",".leaderboard-button",function(){var b=
a(this).attr("data-url");a(this).hasClass("selected")||a.pjax({url:b,container:"#page"})});a(document).on("click",".bot-ranks-list li",function(b){b=a("a",this).first().attr("href");0===a("b",this).length&&b!==n&&a.pjax({url:b,container:"#page"})});a(document).on("click","#leaderboard-table tr",function(){var d;d=a(this).attr("data-rowId");a("#leaderboard-table tr").each(function(){a(this).hasClass("selected")&&a(this).removeClass("selected")});a(this).addClass("selected");a("#leaderboard-sider").hasClass("show")||
(a("#leaderboard-sider").addClass("show"),a("#leaderboard").addClass("show-sider"));d=a("#leaderboard-table").hasClass("instituteLeaderboard")?"/competitions/"+k+"/show-institute-data/"+d:"/competitions/"+k+"/show-player-data/"+d;a.ajax({url:d,context:this}).done(function(d){a("#leaderboard-sider-content").replaceWith(d);a.each(a("script"),function(a,b){-1!==b.innerHTML.indexOf("pjax:end")&&b.remove()});a(".bot-stat").each(function(){0<a(this).find("b").length&&a(this).addClass("current-competition")});
b();g()})});a(document).on("click","#page",function(b){"page"!==b.target.id&&"leaderboard"!==b.target.id||!a("#leaderboard-sider").hasClass("show")||(a("#leaderboard-sider").removeClass("show"),a("#leaderboard").removeClass("show-sider"),a("#leaderboard-table tr").each(function(){a(this).hasClass("selected")&&a(this).removeClass("selected")}))});a(document).on("scroll",function(){var b=a("#leaderboard-sider"),d=c.pageYOffset||document.body.scrollTop;d+12>e&&!b.hasClass("fixed")?b.addClass("fixed"):
d+12<=e&&b.hasClass("fixed")&&a("#menu").hasClass("hidden")?b.removeClass("fixed"):d+12<=e-60&&b.hasClass("fixed")&&!a("#menu").hasClass("hidden")&&b.removeClass("fixed");a("#menu").hasClass("hidden")||b.hasClass("menu-visible")?a("#menu").hasClass("hidden")&&b.hasClass("menu-visible")&&b.removeClass("menu-visible"):b.addClass("menu-visible")});g()};f.CompetitionController.prototype.gameLogAction=function(){app.log("CompetitionController::gameLogAction");var b,g=[],d=a(".js-botData"),e=c.location.href.split("/"),
k=e[4];0>=d.length?d.ready(this.gameLogAction):(b=d.val().split(";"),this.setMenuButtonSelected("Game log"),a(document).on("click",".gamelog-bot-click",function(){var b=a.trim(a(this).children(".div-botName-gameLog").text()),d=e[6];e[6]="a"===d?b:d+"%20"+b;a.pjax({url:e.join("/"),container:"#page"})}),a.each(b,function(a,b){g.push({value:b})}),d=new Bloodhound({local:g,datumTokenizer:function(a){return Bloodhound.tokenizers.whitespace(a.value)},queryTokenizer:Bloodhound.tokenizers.whitespace}),d.initialize(),
a("#search-gameLog").on("tokenfield:createtoken",function(d){var c=d.attrs.value;0>a.inArray(c,b)&&-1===c.indexOf("score<")&&-1===c.indexOf("score>")&&-1===c.indexOf("score=")&&-1===c.indexOf("date>")&&-1===c.indexOf("date=")&&-1===c.indexOf("date<")&&d.preventDefault()}).on("tokenfield:createdtoken tokenfield:editedtoken tokenfield:removedtoken",function(b){var d="";b=a("#search-gameLog").tokenfield("getTokens");"#search-gameLog"!==b.selector&&(queryItems=[],a.each(b,function(){queryItems.push(this.value)}),
1>queryItems.length?d="a":(a.each(queryItems,function(a,b){d+=b+"+"}),d=d.slice(0,-1)),a.pjax({url:"/competitions/"+k+"/game-log/"+d+"/1",container:"#page"}))}).tokenfield({typeahead:[{hint:!0,highlight:!0,minLength:1},{source:d.ttAdapter(),displayKey:"value"}]}),a("#search-gameLog-tokenfield").focus())};f.CompetitionController.prototype.prizesAction=function(){app.log("CompetitionController::prizesAction");this.setMenuButtonSelected("Prizes")};f.CompetitionController.prototype.editAction=function(){app.log("CompetitionController::editAction")};
f.CompetitionController.prototype.semiFinalsAction=function(){app.log("CompetitionController::semiFinalsAction");var a,c,d,e,k;a=document.getElementById("conquest-semifinals");var h=a.getSVGDocument(),f=[],l=[],m=document.getElementById("semifinals-data").getAttribute("data-round"),q="";try{this.setMenuButtonSelected("Semi-finals")}catch(s){}if(null===h||h===n)a.addEventListener("load",this.semiFinalsAction,!1);else for(8<=m&&null!==document.getElementById("round8Loser")&&(q=document.getElementById("round8Loser").innerHTML,
m=8),a=0;a<=m;a++)if(5!==a&&7!==a)for(c=document.getElementById("semifinalsRound"+a).children,d=0;d<c.length;d++)if(e=d-Math.floor(d/3)+1,0!==a%2||0===a)if(0===a)k=h.getElementById("winner"+(d+1)),k.textContent=c[d].innerHTML,f[d+1]=c[d].innerHTML;else{if(0==(d-1)%3){e=f.indexOf(c[d+1].innerHTML);if(0>e)return;h.getElementById("stroke"+e).setAttribute("opacity",1);h.getElementById("R1B"+e).setAttribute("opacity",0.15);1==a?(k=h.getElementById("loser"+Math.ceil(e/2)),k.textContent=f[e]):3==a&&(k=h.getElementById("loser"+
(Math.ceil(e/4)+12)),k.textContent=f[e]);3<=a&&h.getElementById("R3B"+Math.ceil(e/2)).setAttribute("opacity",0.15);d++}}else 2===a&&(k=h.getElementById("loser"+e),k.textContent=c[d].innerHTML,l[e]=c[d].innerHTML),4===a&&(0===e%2&&e--,c[d].innerHTML!=l[e]&&c[d].innerHTML!=l[e+1]&&(e=Math.ceil(e/2)+12,k=h.getElementById("loser"+e),k.textContent=c[d].innerHTML,l[e]=c[d].innerHTML)),0==(d-1)%3&&(6>=a||c[d+1].innerHTML==q)&&(e=l.indexOf(c[d+1].innerHTML),h.getElementById("loserstroke"+e).setAttribute("opacity",
1),12<e?(h.getElementById("R4B"+e).setAttribute("opacity",0.15),6<=a&&h.getElementById("R6B"+(e-12)).setAttribute("opacity",0.15)):(h.getElementById("R2B"+e).setAttribute("opacity",0.15),4<=a&&h.getElementById("R4B"+Math.ceil(e/2)).setAttribute("opacity",0.15),6<=a&&h.getElementById("R6B"+Math.ceil(e/2)).setAttribute("opacity",0.15)),8<=a&&(13===e||14===e||4>=e?(h.getElementById("R8B1").setAttribute("opacity",0.15),h.getElementById("R8T").setAttribute("opacity",0.15),h.getElementById("R8B2P1").setAttribute("opacity",
0.15)):(15===e||16===e||8>=e?h.getElementById("R8B2P1").setAttribute("opacity",0.15):(h.getElementById("R8B3").setAttribute("opacity",0.15),h.getElementById("R8B").setAttribute("opacity",0.15)),h.getElementById("R8B2P2").setAttribute("opacity",0.15))),d++)};f.CompetitionController.prototype.finalsAction=function(){app.log("CompetitionController::finalsAction");var b,g,d,e;b=document.getElementById("conquest-finals");var k=b.getSVGDocument(),f="app.competitions."+l.getCompetitionName();if(null===k||
k===n)b.addEventListener("load",this.finalsAction,!1);else{b=[];g=document.getElementById("finals-data").getAttribute("data-round");for(d=100;d<=g;d++)if(!(105<=d&&108>=d||111===d))if(e=document.getElementById("finalsRound"+d).children,100===d)for(var p=0;p<e.length;p++)k.getElementById("player"+(p+1)).textContent=e[p].innerHTML,b[p+1]=e[p].innerHTML;else idNr=b.indexOf(e[2].innerHTML),k.getElementById("stroke"+idNr).setAttribute("opacity",1),104>=d?k.getElementById("R"+d+"B"+idNr).setAttribute("opacity",
0.12):110>=d?(k.getElementById("R"+d+"B"+Math.ceil(idNr/2)).setAttribute("opacity",0.3),k.getElementById("R"+(100+Math.ceil(idNr/2))+"B"+idNr).setAttribute("opacity",0.3)):112===d&&(k.getElementById("R"+d+"B"+Math.ceil(idNr/4)).setAttribute("opacity",0.45),k.getElementById("R"+(108+Math.ceil(idNr/4))+"B"+Math.ceil(idNr/2)).setAttribute("opacity",0.45),k.getElementById("R"+(100+Math.ceil(idNr/2))+"B"+idNr).setAttribute("opacity",0.45));if(a(".finals-timer").length){l.loadCompetition();var r=function(){c.hasNamespace(f)&&
c.setNamespace(f).game?c.setNamespace(f).game.releaseEventListeners():setTimeout(function(){r()},50)};r();app.log(a(".finals-timer").attr("data-timer"));var k=a(".finals-timer"),m=(new Date(k.attr("data-timer"))).getTime(),k=(new Date(k.attr("data-timenow"))).getTime();b=(new Date).getTime();var q=k-b,s,x,u=function(){var b=(new Date).getTime(),b=(m-(b+q))/1E3;s=parseInt(b/60);x=parseInt(b%60);0<b?a(".finals-timer-right").html(s+"m"+x+"s"):a(".finals-timer-right").html("Refresh for next game...")};
u();setInterval(function(){u()},1E3);a(document).on("pjax:end",l.unloadCompetition)}}};f.CompetitionController.prototype.showFinalsMatchAction=function(){app.log("CompetitionController::showFinalsMatch")};f.CompetitionController.prototype.setMenuButtonSelected=function(b){var c;a.each(a("#competition-menu > .menu-item"),function(){c=a(this).children("a").first();c.html()!==b?c.removeClass("selected"):"selected"!==c.attr("class")&&c.addClass("selected")})}})(window,window.jQuery);
(function(c,a,n){var f=c.setNamespace("app.controller"),l=c.setNamespace("app.snippet");f.HomeController=function(){if(!1===this instanceof f.HomeController)return new f.HomeController(arguments)};f.HomeController.prototype.indexAction=function(){app.log("HomeController::indexAction");l.slideShow()};f.HomeController.prototype.languagesAction=function(){app.log("HomeController::indexAction");a(document).on("click",".edit-language-button",function(b){b=a(this).closest("li").find("#languages-form");
b.removeClass("hidden");b.find("input").focus()})};f.HomeController.prototype.profileAction=function(){function b(b,d){var c,e;p!=b&&(a.each(a(".profile-content-right"),function(b,d){a(this).css("display","none")}),a.each(a(".profile-tab"),function(b,d){d=a(this);d.removeClass("tab-selected");a.each(a(this).attr("class").split(" "),function(a,b){-1!==b.indexOf("competition")&&(c=b.split("_"),d.removeClass(c[1]))})}),p=b,competitionClass="competition_"+p,a(".profile-content-right."+competitionClass).css("display",
"inline-flex"),e=a(".profile-tab."+competitionClass),e.addClass("tab-selected"),e.addClass(p),sessionStorage.setItem("tabSelected",p),a("body").removeAttr("class"),a("body").addClass(p),!d&&0>=a("#profile-rankingOverTime-graph-"+p).find("svg").length&&l.drawRankingGraph(h(),p),g())}function g(){var a=h();if(a!=n&&0<a.find(".compiling").length)c.refreshBotStatusInterval=setInterval(f,1200);else try{c.clearInterval(c.refreshBotStatusInterval)}catch(b){}}function d(){(0<a(".failed").length||""===a("#versions").children().first().text())&&
a("#set-ranked-button").hasClass("disabled")?(a("#set-ranked-button").attr("disabled","true"),a("#set-ranked-button").addClass("disabled")):0===a(".failed").length&&a("#set-ranked-button").hasClass("disabled")&&(a("#set-ranked-button").removeAttr("disabled"),a("#set-ranked-button").removeClass("disabled"))}function e(b){a(document).one("click",function(a){"INPUT"!==a.target.tagName&&b.find("#bot-name").hasClass("hidden")?(b.find("#bot-name").removeClass("hidden"),b.find("#bot-form").addClass("hidden")):
e(b)})}function f(){var b,d=h();b=d.find("#bot-status").attr("data-botId");a.ajax({url:"/refresh/bot-status/"+b+"/",context:this}).done(function(b){if(-1<b.indexOf("failed")||-1<b.indexOf("match success"))c.clearInterval(c.refreshBotStatusInterval),a.pjax.reload("#page");d.find("#bot-status").replaceWith(b)})}function h(){var b;a.each(a(".profile-content-right"),function(d,c){"none"!==a(c).css("display")&&(b=a(c))});return b}app.log("HomeController::profileAction");var p,r=sessionStorage.getItem("tabSelected");
a.each(a(".profile-tab"),function(){if(a(this).hasClass("tab-selected"))return a.each(a(this).attr("class").split(" "),function(b,d){if(-1!==d.indexOf("competition"))return p=d.split("_")[1],a("body").addClass(p),!1}),!1});null!=r&&r!=n&&"undefined"!=r&&b(r,!0);sessionStorage.setItem("tabSelected",p);l.addFileUpload();l.drawRankingGraph(h(),p);a(document).on("click",".profile-tab",function(d){a.each(a(this).attr("class").split(" "),function(a,d){if(-1!==d.indexOf("competition"))return classParts=
d.split("_"),b(classParts[1],!1),!1})});a(document).on("click",".bot-ranks-list li",function(b){b=a("a",this).first().attr("href");a.pjax({url:b,container:"#page"})});a(document).on("click","#edit-botname-button",function(a){a=h();a.find("#bot-name").addClass("hidden");a.find("#bot-form").removeClass("hidden");a.find("#bot-form input").focus();e(a)});a(document).on("change","#versions",function(){var b,c,e=h();b=e.find("#bot-status").attr("data-botId");c=e.find("#versions").val();a.ajax({url:"/refresh/bot-status/"+
b+"/"+c,context:this}).done(function(a){e.find("#bot-status").replaceWith(a);d()})});a(document).on("click",".graph-bar",function(){var b;a(this).children().each(function(){b=a(this).children().first();b.hasClass("show")?b.removeClass("show"):b.addClass("show")})});a(document).on("click",".graph-navigation",function(){a(".bot-graph-container").hasClass("shift-right")?a(".bot-graph-container").removeClass("shift-right"):a(".bot-graph-container").addClass("shift-right")});d();(function(){var b,d,c,
e;a(".graph-bar").each(function(g){b=parseInt(a(this).attr("data-win"));d=parseInt(a(this).attr("data-tie"));c=parseInt(a(this).attr("data-loss"));e=b+d+c;0!=e?(a(this).children("#graph-loss").css("flex-basis",100*c/e+"%"),a(this).children("#graph-tie").css("flex-basis",100*d/e+"%")):a(this).addClass("no-games");a(this).css("opacity",1)})})();g();a.each(a(".js-select-version"),function(){a(this).val(a(this).attr("data-focus"))})};f.HomeController.prototype.editProfileAction=function(){function b(){"none"!==
a(".twitter-typeahead").css("display")&&3<=a(".tokenfield").children("div").length?a(".twitter-typeahead").css("display","none"):"none"===a(".twitter-typeahead").css("display")&&3>a(".tokenfield").children("div").length&&a(".twitter-typeahead").css("display","inline-block")}app.log("HomeController::editProfileAction");var c=[],d=a(".js-instituteData").val().split(";"),e={};a.each(d,function(a,b){c.push({value:b})});d=new Bloodhound({local:c,datumTokenizer:function(a){return Bloodhound.tokenizers.whitespace(a.value)},
queryTokenizer:Bloodhound.tokenizers.whitespace});d.initialize();a("#add-institutes").on("tokenfield:createdtoken tokenfield:editedtoken tokenfield:removedtoken",function(a){b()}).tokenfield({typeahead:[{hint:!0,highlight:!0,minLength:1},{source:d.ttAdapter(),displayKey:"value"}]});a(document).on("click","#edit-profile-confirm",function(b){b=a(".token-input.tt-input").val();1<b.length&&(a("#add-institutes").tokenfield("createToken",b),a(".token-input.tt-input").val(""));e.country=a("#country :selected").text();
e["time-zone"]=a("#time-zone :selected").text();e.notifications=a("#notifications").prop("checked");e.institutes="";a(".token span").each(function(){e.institutes+=a(this).text()+";"});e.institutes=e.institutes.slice(0,-1);a.ajax({type:"POST",url:"/profile/update",data:e});setTimeout(function(){a.pjax({url:"/profile",container:"#page"})},50)});b();0<a("#country").length&&a("#country").val(a("#country").attr("data-focus"));0<a("#time-zone").length&&a("#time-zone").val(a("#time-zone").attr("data-focus"))}})(window,
window.jQuery);
(function(c,a,n){var f=c.setNamespace("app.controller"),l=c.setNamespace("app.snippet");f.DiscussionController=function(){if(!1===this instanceof f.DiscussionController)return new f.DiscussionController(arguments)};f.DiscussionController.prototype.forumAction=function(){app.log("DiscussionController::forumAction");var b=c.location.href.split("/"),g=b[b.length-1];l.addSyntaxHighlighting();a(document).on("click","#forums tr",function(b){"A"!==a(b.target)[0].tagName&&a("a",this).first().click()});a(document).on("click",
"#discussions tr",function(b){if(a(b.target).first().hasClass("fa-trash"))if(confirm("Are you sure you want to delete this discussion?"))b=a(b.target).closest("tr").children().find("a").attr("href").split("/"),b.pop(),b.pop(),b.pop(),b.push("remove"),b=b.join("/"),a.pjax({url:b,container:"#page"});else return!1;else"DIV"!==a(b.target)[0].tagName&&"SPAN"!==a(b.target)[0].tagName||a("a",this).first().click()});a("#search-forum").on("tokenfield:createdtoken tokenfield:editedtoken tokenfield:removedtoken",
function(b){var c=a("#search-forum").tokenfield("getTokens"),f="";a.each(c,function(){f+=this.value+"+"});f=f.slice(0,-1);0>=f.length&&(f="~empty");a.ajax({url:"/discussions/"+g+"/search/"+f+"/search",context:this}).done(function(b){a("#discussions").replaceWith(b);a.each(c,function(){var b=this.value;a(".js-search-text a, .search-description").each(function(){a(this).html(a(this).html().replace(RegExp("\\b("+b+")\\b","gi"),'<span class="highlight-search-forum">$1</span>'))})})})}).tokenfield()}})(window,
window.jQuery);
