(function(f){function e(c,a){var d=/^\w+\:\/\//;/^\/\/\/?/.test(c)?c=location.protocol+c:d.test(c)||"/"==c.charAt(0)||(c=(a||"")+c);return d.test(c)?c:("/"==c.charAt(0)?C:F)+c}function q(c,a){for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d]);return a}function s(c,a,d,b){c.onload=c.onreadystatechange=function(){c.readyState&&"complete"!=c.readyState&&"loaded"!=c.readyState||a[d]||(c.onload=c.onreadystatechange=null,b())}}function y(c){c.ready=c.finished=!0;for(var a=0;a<c.finished_listeners.length;a++)c.finished_listeners[a]();
c.ready_listeners=[];c.finished_listeners=[]}function x(a,b,f,e,p){setTimeout(function(){var h,l=b.real_src,k;if("item"in g){if(!g[0]){setTimeout(arguments.callee,25);return}g=g[0]}h=document.createElement("script");b.type&&(h.type=b.type);b.charset&&(h.charset=b.charset);p?z?(a[n]&&m("start script preload: "+l),f.elem=h,D?(h.preload=!0,h.onpreload=e):h.onreadystatechange=function(){"loaded"==h.readyState&&e()},h.src=l):p&&0==l.indexOf(C)&&a[G]?(k=new XMLHttpRequest,a[n]&&m("start script preload (xhr): "+
l),k.onreadystatechange=function(){4==k.readyState&&(k.onreadystatechange=function(){},f.text=k.responseText+"\n//@ sourceURL="+l,e())},k.open("GET",l),k.send()):(a[n]&&m("start script preload (cache): "+l),h.type="text/cache-script",s(h,f,"ready",function(){g.removeChild(h);e()}),h.src=l,g.insertBefore(h,g.firstChild)):(d?(a[n]&&m("start script load (ordered async): "+l),h.async=!1):a[n]&&m("start script load: "+l),s(h,f,"finished",e),h.src=l,g.insertBefore(h,g.firstChild))},0)}function v(){function c(a,
c,d){function b(){null!=e&&(e=null,y(d))}var e;l[c.src].finished||(a[E]||(l[c.src].finished=!0),e=d.elem||document.createElement("script"),c.type&&(e.type=c.type),c.charset&&(e.charset=c.charset),s(e,d,"finished",b),d.elem?d.elem=null:d.text?(e.onload=e.onreadystatechange=null,e.text=d.text):e.src=c.real_src,g.insertBefore(e,g.firstChild),d.text&&b())}function d(a,b,f,h){var t,g,p=function(){b.ready_cb(b,function(){c(a,b,t)})},k=function(){b.finished_cb(b,f)};b.src=e(b.src,a[B]);b.real_src=b.src+
(a[H]?(/\?.*$/.test(b.src)?"&_":"?_")+~~(1E9*Math.random())+"=":"");l[b.src]||(l[b.src]={items:[],finished:!1});g=l[b.src].items;a[E]||0==g.length?(t=g[g.length]={ready:!1,finished:!1,ready_listeners:[p],finished_listeners:[k]},x(a,b,t,h?function(){t.ready=!0;for(var a=0;a<t.ready_listeners.length;a++)t.ready_listeners[a]();t.ready_listeners=[]}:function(){y(t)},h)):(t=g[0],t.finished?k():t.finished_listeners.push(k))}function r(){function c(a,b){h[n]&&m("script preload finished: "+a.real_src);a.ready=
!0;a.exec_trigger=b;e()}function b(a,c){h[n]&&m("script execution finished: "+a.real_src);a.ready=a.finished=!0;a.exec_trigger=null;for(var d=0;d<c.scripts.length;d++)if(!c.scripts[d].finished)return;c.finished=!0;e()}function e(){for(;k<g.length;)if("[object Function]"==Object.prototype.toString.call(g[k])){h[n]&&m("$LAB.wait() executing: "+g[k]);try{g[k++]()}catch(c){h[n]&&a("$LAB.wait() error caught: ",c)}}else{if(!g[k].finished){for(var b=g[k],d=!1,f=0;f<b.scripts.length;f++)b.scripts[f].ready&&
b.scripts[f].exec_trigger&&(d=!0,b.scripts[f].exec_trigger(),b.scripts[f].exec_trigger=null);if(d)continue;break}k++}k==g.length&&(r=l=!1)}var f,h=q(w,{}),g=[],k=0,l=!1,r;f={script:function(){for(var a=0;a<arguments.length;a++){var e=arguments[a],k=arguments[a],n=void 0;"[object Array]"==Object.prototype.toString.call(e)||(k=[e]);for(var m=0;m<k.length;m++)r&&r.scripts||g.push(r={scripts:[],finished:!0}),e=k[m],"[object Function]"==Object.prototype.toString.call(e)&&(e=e()),e&&("[object Array]"==
Object.prototype.toString.call(e)?(n=[].slice.call(e),n.unshift(m,1),[].splice.apply(k,n),m--):("string"==typeof e&&(e={src:e}),e=q(e,{ready:!1,ready_cb:c,finished:!1,finished_cb:b}),r.finished=!1,r.scripts.push(e),d(h,e,r,u&&l),l=!0,h[p]&&f.wait()))}return f},wait:function(){if(0<arguments.length){for(var a=0;a<arguments.length;a++)g.push(arguments[a]);r=g[g.length-1]}else r=!1;e();return f}};return{script:f.script,wait:f.wait,setOptions:function(a){q(a,h);return f}}}var w={},u=z||b,h=[],l={},k;
w[G]=!0;w[p]=!1;w[E]=!1;w[H]=!1;w[n]=!1;w[B]="";return k={setGlobalDefaults:function(a){q(a,w);return k},setOptions:function(){return r().setOptions.apply(null,arguments)},script:function(){return r().script.apply(null,arguments)},wait:function(){return r().wait.apply(null,arguments)},queueScript:function(){h[h.length]={type:"script",args:[].slice.call(arguments)};return k},queueWait:function(){h[h.length]={type:"wait",args:[].slice.call(arguments)};return k},runQueue:function(){for(var a=k,c=h.length,
b;0<=--c;)b=h.shift(),a=a[b.type].apply(null,b.args);return a},noConflict:function(){f.$LAB=A;return k},sandbox:function(){return v()}}}var A=f.$LAB,G="UseLocalXHR",p="AlwaysPreserveOrder",E="AllowDuplicates",H="CacheBust",n="Debug",B="BasePath",F=/^[^?#]*\//.exec(location.href)[0],C=/^\w+\:\/\/\/?[^\/]+/.exec(F)[0],g=document.head||document.getElementsByTagName("head"),I=f.opera&&"[object Opera]"==Object.prototype.toString.call(f.opera)||"MozAppearance"in document.documentElement.style,m=function(){},
a=m,u=document.createElement("script"),D="boolean"==typeof u.preload,z=D||u.readyState&&"uninitialized"==u.readyState,d=!z&&!0===u.async,b=!z&&!d&&!I;f.console&&f.console.log&&(f.console.error||(f.console.error=f.console.log),m=function(a){f.console.log(a)},a=function(a,b){f.console.error(a,b)});f.$LAB=v();(function(a,b,d){null==document.readyState&&document[a]&&(document.readyState="loading",document[a](b,d=function(){document.removeEventListener(b,d,!1);document.readyState="complete"},!1))})("addEventListener",
"DOMContentLoaded")})(this);
(function(f,e,q){var s,y,x,v,A=!1;x=function(){$LAB.script("/components/blueimp-file-upload/js/vendor/jquery.ui.widget.js").script("/components/blueimp-file-upload/js/jquery.fileupload.js").script("/components/blueimp-file-upload/js/jquery.iframe-transport.js").script("/components/bootstrap-tokenfield/dist/bootstrap-tokenfield.js").script("/components/typeahead.js/dist/typeahead.bundle.js").script("/js/slider.js").script("/js/app.min.js?2.5.0").wait(y)};v=function(f,p){var q,s=function(){e.clearTimeout(q);
if(!A)try{f[p].test(),A=!0,f[p].success()}catch(n){p<f.length-1&&v(f,p+1)}};null==p&&(p=0);$LAB.script(f[p].src).wait(s);q=e.setTimeout(s,3E3)};s=function(){return e.hasOwnProperty("jQuery")};v([{src:"//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js",test:s,success:function(){$LAB.script("//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js").script("//cdnjs.cloudflare.com/ajax/libs/jquery.pjax/1.7.0/jquery.pjax.min.js").script("//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/CSSPlugin.min.js").script("//cdnjs.cloudflare.com/ajax/libs/gsap/latest/easing/EasePack.min.js").script("//cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenLite.min.js").script("//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.2/raphael-min.js").script("//cdnjs.cloudflare.com/ajax/libs/graphael/0.5.1/g.raphael-min.js").script("//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js").script("//cdnjs.cloudflare.com/ajax/libs/hammer.js/1.1.3/hammer.min.js").script("//cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js").script("//cdnjs.cloudflare.com/ajax/libs/hammer.js/1.0.5/jquery.hammer.min.js").script("//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js").wait(x)}},
{src:"/js/components/jquery/dist/jquery.min.js",test:s,success:function(){$LAB.script("/components/jquery-ui/jquery-ui.min.js").script("/components/jquery/jquery.pjax.js").script("/components/gsap/latest/plugins/CSSPlugin.min.js").script("/components/gsap/latest/easing/EasePack.min.js").script("/components/gsap/latest/TweenLite.min.js").script("/components/raphael/raphael-min.js").script("/components/g.raphael/g.raphael-min.js").script("/components/mousetrap/mousetrap.min.js").script("/components/hammerjs/hammer.min.js").script("/components/prettify/index.js").script("/components/jquery-cookie/jquery.cookie.min.js").wait(x)}}]);
y=function(){function s(){var d="state"in e.history&&null!==e.history.state;e.initialURL=location.href;a(e).bind("popstate",function(b){var c=!d&&location.href==e.initialURL;d=!0;if(!c&&(b=b.state)&&b.container){var c=b.url||location.href,f=c.split("/");"game"===f[5]&&"challenge"===f[6]?(f[5]="leaderboard",f[6]="global",f[7]="a",f[8]="",c=f.join("/"),e.location.href=c):a.pjax({url:c,container:b.container,push:!1,timeout:b.timeout})}});a(f).on("drop dragover",function(a){a.preventDefault()});a(f).on("submit",
"form[data-pjax]",function(b){a.pjax.submit(b,"#page");B()});a(f).pjax("a[data-pjax]","#page");a(f).on("click",".upload-bot-form",function(){var b=a("input",this).get(0);b!=q&&b.click()});a(f).on("click","footer a, .menu-item, #forum, .competitions-list, #join-button",function(){a(f).on("pjax:end",function(){e.scrollTo(0,0)})});a(f).on("click",".menu-item",function(b){var c=a("a",this).first().attr("href");c!==q&&"A"!==a(b.target)[0].tagName&&a.pjax({url:c,container:"#page"});c===q?(p(),a("#username").focus()):
0<=c.search("sign-")&&B()});a(f).on("submit","#login-form-sider",function(a){p()});a(f).on("click","#page",function(a){v()});a(f).on("click","#user-avatar",function(b){var c=a("a",a(this).next()).attr("href");1===b.which&&a.pjax({url:c,container:"#page"})});a(f).on("scroll",function(b){var c=f.body;b=a("#menu");var d=a(".alertBar"),c=e.pageYOffset||c.scrollTop,g=a(e).data("lastScrollTop")||0,m=parseInt(b.css("height"));c>g&&c>m&&"hidden"!==b.attr("class")?(b.addClass("hidden"),a("#sider-content").addClass("menu-hidden"),
d!==q&&"none"!==d.css("display")&&d.addClass("hidden")):c<g&&"hidden"===b.attr("class")&&(b.removeClass("hidden"),a("#sider-content").removeClass("menu-hidden"),d!==q&&"none"!==d.css("display")&&d.removeClass("hidden"));a(e).data("lastScrollTop",c);y()});a(f).on("click",".alert-notice",function(b){var c;b=a(b.target).closest("div").find("a");b!==q&&(c=b.attr("href"));a.pjax({url:c,container:"#page"})})}function p(){var d=a("#sider");"show"===d.attr("class")?(d.removeClass("show"),a("#page").removeClass("showSider"),
a("footer").removeClass("showSider")):(d.addClass("show"),a("#page").addClass("showSider"),a("footer").addClass("showSider"))}function v(){var d=a("#sider");"show"===d.attr("class")&&(d.removeClass("show"),a("#page").removeClass("showSider"),a("footer").removeClass("showSider"))}function y(){var a=f.body;e.clearTimeout(m);a.classList.contains("disable-hover")||a.classList.add("disable-hover");m=setTimeout(function(){a.classList.remove("disable-hover")},200)}function n(){var d=a(".alertBar");d!==q&&
0<d.length&&"none"!==d.css("display")&&0.5<d.css("opacity")&&d.delay(8E3).animate({opacity:0},500,function(){d.css("display","none")})}function B(){a.ajax({url:"/reload/menu",context:this}).done(function(d){a("#menu").replaceWith(d);a("body").hasClass("warlight-ai-challenge")&&a(".header-text").addClass("show")});a.ajax({url:"/reload/sider",context:this}).done(function(d){a("#sider").replaceWith(d)})}function x(){A=e.setInterval(function(){a.ajax({url:"/empty"})},24E4)}function C(){var d=e.location.href.split("/"),
b=d.indexOf("competitions"),c=d.indexOf("discussions");a("body").removeAttr("class");-1!==b?(d=d[b+1],a("body").addClass(d),"warlight-ai-challenge"===d&&a(".header-text").addClass("show")):-1!==c&&a("body").addClass("style-discussions")}function g(d){var b=e.location.href.split("/");if(7===b.length&&"warlight-ai-challenge"===b[4]&&"semi-finals"===b[5]){var c=a("#conquest-semifinals").outerHeight();d&&(d=0.6*a(e).width(),c=1805*(d/1855),g(!1));a("#semifinals-overlays").children().each(function(){a(this).css("height",
c)})}else 7===b.length&&"warlight-ai-challenge"===b[4]&&"finals"===b[5]&&(c=a("#conquest-finals").outerHeight(),d&&(d=0.9*a(e).width(),c=603*(d/1855),g(!1)),a("#finals-overlays").children().each(function(){a(this).css("height",c)}))}var A,m,a=e.jQuery,u=e.setNamespace("app"),D=new u.Router(u.config.routes),z=function(d){a(f).off();a(e).off();a.each(a("script"),function(a,b){-1!==b.innerHTML.indexOf("pjax:end")&&b.remove()});try{e.clearInterval(slideShowInterval)}catch(b){}if("/profile"!==e.location.pathname)try{e.clearInterval(refreshBotStatusInterval)}catch(c){}C();
g(!0);B();s();n();v();D.route();e.clearTimeout(A);x();a("#leaderboard-table").css("width","646px");a(f).on("pjax:end",z)};u.log=function(a){e.app.debug&&console.log(a)};C();g(!1);s();n();a.pjax.defaults.scrollTo=!1;D.route();x();a(f).on("pjax:end",z);a(e).resize(function(){g(!1)})}})(document,window);
